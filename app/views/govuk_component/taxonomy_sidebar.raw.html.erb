<%# Deprecated - taxonomy links are now coerced into the related links component %>
<% if local_assigns[:items] && !items.blank? %>
  <%
    elsewhere_on_govuk = {
      title: 'Elsewhere on GOV.UK',
      items: []
    }

    sections = []
    items.each do |i|
      if i[:related_content] && i[:related_content].any?
        related_content_items = i[:related_content].map do |related_content_link|
                                  related_content_link[:url] = related_content_link.delete :link
                                  related_content_link
                                end

        sections << {
          title: i[:title],
          url: i[:url],
          items: i[:related_content]
        }
      else
        elsewhere_on_govuk[:items] << {
          title: i[:title],
          url: i[:url]
        }
      end
    end

    if elsewhere_on_govuk[:items].any?
      sections << elsewhere_on_govuk
    end
  %>
  <%= render file: 'govuk_component/related_items.raw', locals: { sections: sections } %>
<% end %>
